<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TV ZERO-RAM</title>
    <style>
        :root { --accent: #00d4ff; --bg: #000; }
        
        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; background: none; }

        body {
            background: var(--bg);
            color: #fff;
            font-family: system-ui, sans-serif;
            overflow: hidden;
            height: 100vh;
            display: flex;
        }

        /* Panel Izquierdo: Info (Sólido, sin efectos) */
        .info-panel {
            width: 40%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-right: 1px solid #111;
            background: #000;
        }

        .main-logo-box {
            width: 200px; height: 200px;
            background: #fff;
            border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            margin-bottom: 20px;
        }
        .main-logo-box img { width: 90%; height: 90%; object-fit: contain; }

        .title-text { font-size: 2rem; font-weight: bold; text-align: center; padding: 0 10px; }

        /* Panel Derecho: Lista (4 elementos máximo) */
        .list-panel {
            width: 60%;
            display: flex; flex-direction: column;
            justify-content: center;
            padding: 0 5%;
        }

        .row {
            height: 80px;
            margin: 5px 0;
            background: #080808;
            border: 2px solid #1a1a1a;
            border-radius: 8px;
            display: flex; align-items: center;
            padding: 0 15px;
            transition: none; /* Desactivar transiciones para ahorrar CPU */
        }

        .row:focus {
            background: var(--accent);
            color: #000;
            border-color: #fff;
        }

        .row-num { width: 40px; font-weight: bold; opacity: 0.6; }
        .row-name { font-size: 1.3rem; font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        
        /* Indicador de carga */
        .status { position: fixed; top: 20px; right: 20px; color: var(--accent); font-size: 0.8rem; font-weight: bold; }
    </style>
</head>
<body>

<div class="status" id="st">CONECTANDO...</div>

<div class="info-panel">
    <div class="main-logo-box">
        <img id="m-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
    </div>
    <div class="title-text" id="m-title">LISTA TV</div>
</div>

<div class="list-panel" id="table"></div>

<script>
    const M3U = "https://raw.githubusercontent.com/R3D-GHOST/json/refs/heads/main/CV.m3u8";
    let chs = [];
    let bIdx = 0;
    const SIZE = 4;

    async function init() {
        try {
            const r = await fetch(M3U);
            const t = await r.text();
            const lines = t.split('\n');
            for(let i=0; i<lines.length; i++) {
                if(lines[i].includes('#EXTINF')) {
                    const n = lines[i].split(',')[1]?.trim() || "Canal";
                    const l = lines[i].match(/tvg-logo="([^"]+)"/)?.[1] || "";
                    const u = lines[i+1]?.trim();
                    if(u && u.startsWith('http')) chs.push({n, l, u});
                }
            }
            render(0);
        } catch(e) { document.getElementById('st').innerText = "ERROR"; }
    }

    function render(b) {
        const table = document.getElementById('table');
        table.innerHTML = ''; // Purga instantánea de memoria
        
        const start = b * SIZE;
        const end = Math.min(start + SIZE, chs.length);

        for(let i=start; i<end; i++) {
            const c = chs[i];
            const row = document.createElement('div');
            row.className = 'row';
            row.tabIndex = 0;
            row.innerHTML = `<div class="row-num">${i+1}</div><div class="row-name">${c.n}</div>`;

            row.onfocus = () => {
                document.getElementById('m-title').innerText = c.n;
                document.getElementById('m-img').src = c.l;
                document.getElementById('st').innerText = `BLOQUE ${b+1} | ${i+1}/${chs.length}`;
            };

            row.onkeydown = (e) => {
                if(e.key === 'Enter') window.location.href = c.u;
                if(e.key === 'ArrowDown' && i === end - 1 && end < chs.length) {
                    bIdx++; render(bIdx);
                }
                if(e.key === 'ArrowUp' && i === start && b > 0) {
                    bIdx--; render(bIdx);
                    setTimeout(() => table.children[SIZE-1].focus(), 1);
                }
            };
            table.appendChild(row);
        }
        table.children[0]?.focus();
    }

    init();
</script>
</body>
</html>
